# Introduction

A while ago, I called my brother to discuss a certain matter. He works in a sawmill, and usually, during our phone conversations, I could hardly hear his voice clearly due to the background noise. However, during our last call, the situation was completely different ‚Äî his voice was very clear and free of any annoying or harsh sounds, to the point where I thought he was outside the workshop. When I asked him where he was, he replied that he was still inside the workshop.

This was very interesting and thought-provoking for me, as it was the first time I could hear his voice without the usual disturbances. The reason for this improvement was that he had recently purchased a new mobile phone. This experience made me wonder how a phone can transmit the main voice signal with high quality while simultaneously suppressing the surrounding noise.

In this project, I decided to simulate a simplified version of this process. To do so, I will record a short audio clip of my own voice in the presence of a constant noise source (such as a fan). The goal is to use filters and signal processing techniques to reduce the environmental noise as much as possible and extract a clearer, more intelligible signal.

In this project, we plan to implement filters such as a low-pass filter, notch filter, adaptive filter (LMS), spectral subtraction, and Wiener filter using MATLAB. After applying each filter to the audio signal, we will analyze the results to evaluate the impact of each method and determine whether there has been an improvement in sound quality. Finally, we will try to combine the methods that produced the best results and assess whether the final output approaches our desired quality level.

Obviously, no filter can completely eliminate noise, but this challenge itself provides motivation to continue the project. If I have enough time, I am also interested in extending this work by applying machine learning models and exploring AI-based approaches to further improve the signal quality.

<p align="center">
  <img src="https://github.com/user-attachments/assets/d888b14b-c9d4-4dc3-9f25-48a39429047e" width="500"/>
</p>


# Orginal Signal
At the beginning of the project, I recorded an audio file of my voice in front of a fan. The purpose of this step is to observe and analyze the time-domain waveform of the original signal (Recording 8.wav) as well as its frequency content using a spectrogram.

<p align="center">
  <img src="https://github.com/user-attachments/assets/ffe62523-c344-4b00-92df-7a6f7fef3eeb" width="1200"/>
</p>


From these two plots ‚Äî especially the spectrogram ‚Äî valuable information can be obtained. As shown, the total duration of the signal is about 7 seconds, and my speech starts after the 4-second mark. During the first four seconds, only environmental noise is recorded.

As you know, the main energy of speech signals is concentrated in lower frequencies. Therefore, it seems that by using a low-pass filter, we can remove most of the high-frequency noise and obtain a cleaner and clearer signal. I plan to use this filter to attenuate frequency components above 2 kHz.

# Low Pass Filter

<p align="center">
  <img src="https://github.com/user-attachments/assets/04e89645-7f27-46fb-9c6a-af3fe8a77094" width="1200"/>
</p>


Based on the results obtained from this filter, it can be concluded that, according to the spectrogram, the high-frequency components of the signal have been almost completely attenuated. However, when listening to the output file lowPassFilterAudio.wav, I realize that although the high-frequency noise has been removed, the low-frequency noise still remains, and there is no significant difference compared to the original signal.

At this stage, it appears that most of the noise present in the original signal lies within the lower frequency range. This indicates that the speech signal overlaps with the frequency range of the noise generated by the fan.

Given this observation, it seems appropriate to apply a notch filter to the original signal in order to selectively remove a narrow and specific frequency band, which may help further reduce the remaining noise.


# notch Filter


Based on the spectrogram plot, it can be observed that there are high-energy components, indicated by the yellow regions, approximately in the frequency range below 1 kHz. Considering that only environmental noise and the sound of the fan were present during the time interval from 0 to 4 seconds, it can be inferred that this high energy is mainly due to the background noise.

Therefore, if we can filter out a narrow band within this range ‚Äî for example, around 200 Hz with a bandwidth of approximately 1,000 Hz ‚Äî it may be possible to obtain a cleaner and higher-quality signal compared to the original.


<p align="center">
  <img src="https://github.com/user-attachments/assets/09bc173d-f78a-4fa8-8fc5-732132ec8f82" width="1200"/>
</p>


Based on the plots, it is evident that the notch filter has effectively attenuated the target frequency components and significantly reduced a large portion of the noise. However, when listening to the filtered audio output, it becomes clear that although the noise has been substantially reduced, the overall power of the original signal has also decreased.

It appears that amplifying the signal after applying the notch filter might help improve the perceived quality of the speech. Nonetheless, it is important to note that such amplification may also enhance any remaining noise, which requires careful consideration.

The main challenge in this project is that certain frequency components of the speech signal overlap with the dominant noise frequencies. Therefore, if these noisy frequency bands are entirely filtered out, essential parts of the speech signal may also be lost.

As a result, it seems more appropriate to use a filter capable of intelligently distinguishing between the speech signal and the noise. Such a filter can better preserve the quality of the speech while effectively reducing noise by identifying and separating the unique features of each.


# Adaptive Filter(LMS)

Adaptive filters are dynamic filters whose coefficients automatically change over time to minimize a specified error criterion. This feature makes them highly effective in non-stationary environments, where the characteristics of noise or interference continuously vary.

The LMS (Least Mean Squares) algorithm is one of the simplest and most widely used methods for updating the coefficients of an adaptive filter. This algorithm iteratively adjusts the filter coefficients to minimize the mean squared error between the desired signal and the filter output. Due to its simplicity and low computational cost, the LMS algorithm is extensively used in applications such as real-time noise cancellation, echo suppression, and system identification. Overall, LMS-based adaptive filters play a crucial role in modern signal processing, particularly in scenarios where traditional fixed filters are not sufficient.

In this section, we plan to use such a filter. To implement the LMS approach, a reference noise signal is typically required ‚Äî one that closely resembles the noise present in the primary signal. However, since a separate reference signal is not available in this project, we assume that during the first 0 to 4 seconds of the audio file, only environmental noise is recorded without any speech content. Therefore, we can use this segment as the reference noise signal.


<p align="center">
  <img src="https://github.com/user-attachments/assets/4a955fd1-2e6c-4097-9b6e-79d2f8e1c03f" width="1200"/>
</p>

Based on the time-frequency spectrogram analysis of the signal before and after applying the LMS filter, it can be observed that the filter has effectively reduced the high-energy noise regions, which appear as yellow areas in the spectrogram. In other words, the filter gradually identifies the environmental noise and, by continuously updating its coefficients, suppresses it effectively. This behavior highlights the adaptive capability of the filter; over time, it learns and becomes "accustomed" to the noise structure, resulting in a significant improvement in the quality of the output signal.
The parameter 
ùúá
Œº (learning rate) plays a critical role in this process, as adjusting it controls the speed and extent of the coefficient updates, directly influencing the effectiveness of noise suppression.
Overall, this filter has demonstrated successful performance in reducing stationary or slowly varying noise; however, when listening to the output audio, it can be noticed that the speech signal intensity is also slightly reduced, which is considered a common drawback of adaptive noise cancellation techniques.


# Spectral Subtraction
Considering the rather unsatisfactory performance obtained from the previous approach (due to the attenuation of the speech signal), I decided to try a new method.

Spectral subtraction is a classical and widely used technique for noise reduction in audio signals, especially in speech enhancement applications. The core idea of this method is based on estimating the noise spectrum from portions of the signal where only noise is present (i.e., there is no speech or desired signal in those segments).

Once an estimate of the noise spectrum is obtained, this spectrum is subtracted from the noisy signal‚Äôs spectrum to emphasize the components of the original signal.

In practice, the signal is first divided into short, overlapping frames. Each frame is then transformed into the frequency domain using the Short-Time Fourier Transform (STFT). The average spectrum of the noise-only segments is stored as the noise reference profile. This reference spectrum is then subtracted from each noisy frame‚Äôs spectrum. Any resulting negative values from this subtraction are set to zero to avoid introducing artificial noise.

Finally, the modified magnitude spectrum is combined with the original phase information, and the time-domain signal is reconstructed using the Inverse Short-Time Fourier Transform (ISTFT).

Although this method is simple and computationally efficient, it may introduce artificial noise or unpleasant artifacts (commonly referred to as musical noise) if the noise is inaccurately estimated or if there are rapid variations in the noise characteristics.


<p align="center">
  <img src="https://github.com/user-attachments/assets/b154dc15-74a5-43f5-a344-dd9e7afcf753" width="1200"/>
</p>



From the analysis of the plots, it can be concluded that this method has effectively filtered the noise to a considerable extent and demonstrated satisfactory performance. However, the most important criterion for evaluation is the quality of the output audio file.

After listening to the file Recording8_Cleaned.wav, it appears that the environmental noise has been largely removed, and the speech signal power has been preserved without significant attenuation.

Nonetheless, one notable drawback of this method is the occurrence of musical noise, which manifests as unnatural and unpleasant sounds in the background of the audio file.


# ImprovedSpectralSubtraction


To improve this method, I introduced a parameter called alpha. By adjusting this parameter, the noise energy is reduced more aggressively than the initially estimated amount, which helps to suppress the rapid spectral fluctuations responsible for producing musical noise. Based on the experimental results obtained in MATLAB, I set the optimal value of this parameter to 3.5.

Afterward, I defined another parameter called the spectral floor. This parameter prevents the spectrum from being excessively reduced to zero and ensures that very low-energy spectral components are partially preserved. As a result, the likelihood of musical noise artifacts is significantly diminished.

Despite these improvements, reducing musical noise led to a slight attenuation of the speech signal. Therefore, it was necessary to carefully and conservatively amplify the signal to avoid enhancing any remaining weak noise components.

Before final amplification, the output signal was normalized to bring it back to the [‚àí1,1] range and to ensure the overall energy level remained natural. Finally, a small gain factor of 1.2 was applied to the cleaned signal to restore its loudness closer to the original level without introducing additional noise or distortion. In the last step, the signal was limited to prevent clipping.


<p align="center">
  <img src="https://github.com/user-attachments/assets/ce1a1716-f407-421a-9b63-709e564875d3" width="1200"/>
</p>


The results obtained from this filter are very satisfactory; according to the spectrogram, most of the noise present in the original signal has been effectively removed. More importantly, when listening to the filtered audio file, the speech can be heard clearly and almost without any noise.

Of course, stating that ‚Äúthere is no noise at all‚Äù would be somewhat exaggerated; however, it can be said that the signal has been largely cleaned and a satisfactory quality has been achieved.

One important point I realized during this project is that when using any filter ‚Äî even if it is not clearly perceptible in the output ‚Äî a part of the energy or fine details of the original signal is always unintentionally reduced. In general, filters may not only remove noise but also weaken some important components of the target signal, which should always be taken into consideration.

Nevertheless, as mentioned at the beginning, I also intend to explore and evaluate the Wiener filter. Therefore, in the following steps, this filter will also be applied.


# ImprovedSpectralSubtraction

The Wiener filter is one of the well-known and effective methods in signal processing for noise reduction and signal quality enhancement. This filter is designed based on the principle of minimizing the mean squared error (MMSE), aiming to provide an optimal estimate of the original signal in the presence of noise.

In practice, the Wiener filter calculates the signal-to-noise ratio (SNR) in the frequency domain and applies a gain to the signal that suppresses noisy components while preserving the essential parts of the original signal.

Due to its strong capability to reduce noise while maintaining signal quality, this approach is widely used in many practical applications, especially in audio and image processing, as well as in communication systems.








